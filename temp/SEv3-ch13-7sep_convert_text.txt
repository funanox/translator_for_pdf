Chapter 13Locks and AlarmsFor if a man watch too long, it is odds he will fall asleepe.
– FRANCIS BACONThe greatest of faults, I should say,is to be conscious of none.
– THOMAS CARLYLE13.
1IntroductionMost security engineers nowadays focus on electronic systems, but physical pro-tection cannot be neglected.
 First, if you’re advising on a company’s overall riskmanagement, then walls and locks are a factor.
 Second, as it’s easier to teachsomeone with an electrical engineering or computer science background the ba-sics of physical security than the other way round, interactions between physicaland logical protection are usually up to the systems person to manage.
 Third,you will often be asked for your opinion on your client’s installations – whichmay have been built by contractors with little understanding of system issues.
You’ll need to be able to give informed, but diplomatic, advice.
 Fourth, manyinformation security mechanisms can be defeated if a bad man gets physicalaccess, whether at the factory, or during shipment, or before installation.
 Fifth,many mechanical locks have recently been completely compromised by ‘bump-ing’, an easy covert-entry technique; their manufacturers often seem unaware ofvulnerabilities that enable their products to be quickly bypassed.
 Finally, manyof the electronic locks that are replacing them are easy to compromise, eitherbecause they use cryptography that’s been broken (such as Mifare classic) orbecause of poor integration of the mechanical and digital components.
Much of physical security is just common sense, but there are some non-obvious twists and there have been signiﬁcant recent advances in technology.
There are useful ideas from criminology and architecture on how you can reducethe incidence of crime around your facilities; some of these may go across intosystem design too.
 And there’s a very interesting case study in burglar alarms.
43413.
2.
 THREATS AND BARRIERSFor example, in order to defeat a burglar alarm it’s enough to make it stopworking, or even just to persuade the guards that it has become unreliable.
 Thisgives a new perspective on denial of service attacks.
 Just as we’ve seen militarymessaging systems designed to enforce conﬁdentiality and bookkeeping systemswhose goal is preserving record authenticity, monitoring gives us the classicexample of systems that need to be dependably available.
 If there is a burglarin my bank vault, then I don’t care very much who else gets to know (so I’mnot worried about conﬁdentiality), or who it was who told me (so authenticityisn’t a major concern); but I do care very much that an attempt to tell me isnot thwarted.
 Historically, about 90% of computer security research was aboutconﬁdentiality, about 9% about authenticity and 1% about availability.
 Butactual attacks – and companies’ infosec expenditures – are often the other wayround, with more spent on availability than on authenticity and conﬁdentialitycombined.
And it’s alarm systems, above all else, that can teach us aboutavailability.
13.
2Threats and BarriersPhysical security engineering is no di↵erent at heart from the digital variety:you perform a threat analysis, then design a system that involves equipmentand procedures, then test it.
 You evaluate it according to criteria agreed withthe customer, which in 2019 may mean that a bank headquarters building has aspeciﬁcation setting out ﬁve years’ maintenance cost, building software penetra-tion testing and a security policy [350].
 The design and testing of entry controlsand alarms is driven by a policy based on:Deter – detect – alarm – delay – respondA facility can deter intruders using hard methods such as concrete walls,or softer methods such as being inconspicuous.
 It will then have one or morelayers of barriers and sensors whose job is to keep out casual intruders, detectdeliberate intruders, and make it di�cult for them to get in too quickly.
 Thiswill be complemented by an alarm system designed to get a response to thescene in time.
As the barriers will have doors for authorized sta↵ to go inand out, there will be entry control that could be anything from metal keys tobiometric scanners.
 Finally, these measures will be supported by operationalcontrols.
 How do you cope, for example, with your facility manager having hisfamily taken hostage?As I noted earlier, one of the ways in which you get your sta↵ to accept dualcontrols and integrate them into their work culture is that these controls protectthem, as well as protecting the assets.
You need to embed the operationalaspects of security in the ﬁrm’s culture or they won’t work well, and this appliesto physical security just as much as to the computer variety.
 It’s also vital toget uniﬁed operational security across the physical, business and informationdomains: there’s little point in spending $10m to protect a vault containing$100m of diamonds if a bad man can sneak a false delivery order into yoursystem, and send a courier to pick up the diamonds from reception.
Thatis another reason why, as the information security expert, you have to paySecurity Engineering435Ross Anderson13.
2.
 THREATS AND BARRIERSattention to the physical side too.
13.
2.
1Threat modelAn important design consideration is the attacker’s level of skill, equipment andmotivation.
 And as we’ve seen in one context after another, security isn’t ascalar.
 It doesn’t make sense to ask ‘Is device X secure?’ without a context:‘secure against whom and in what environment?’In the absence of an ‘international standard burglar’, the nearest I know toa working classiﬁcation is one developed by a US Army expert [173].
• Derek is a 19-year old addict.
 He’s looking for a low-risk opportunity tosteal something he can sell for his next ﬁx.
• Charlie is a 40-year old inadequate with seven convictions for burglary.
He’s spent seventeen of the last twenty-ﬁve years in prison.
 Although notvery intelligent he is cunning and experienced; he has picked up a lot of‘lore’ during his spells inside.
 He steals from small shops and suburbanhouses, taking whatever he thinks he can sell to local fences.
• Bruno is a ‘gentleman criminal’.
 His business is mostly stealing art.
 As acover, he runs a small art gallery.
 He has a (forged) university degree inart history on the wall, and one conviction for robbery eighteen years ago.
After two years in jail, he changed his name and moved to a di↵erent partof the country.
 He has done occasional ‘black bag’ jobs for intelligenceagencies who know his past.
 He’d like to get into computer crime, but themost he’s done so far is lock hacking and alarm tampering.
• Abdurrahman heads a cell of a dozen agents, most with military training.
They have access to weapons and explosives, with PhD-grade technicalsupport provided by his home country.
 Abdurrahman himself came thirdout of a class of 280 at its military academy.
 His mission is to deal with thecountry’s opponents overseas, typically by covert entry into their homes oro�ces to plant listening devices or to install malware into their computersand phones.
 One of the possible missions that his agency and governmentare considering is to steal plutonium.
 He thinks of himself as a good manrather than a bad man.
So Derek is unskilled, Charlie is skilled, Bruno is highly skilled and mayhave the help of an unskilled insider such as a cleaner, while Abdurrahman isnot only highly skilled but has substantial resources.
 He may even have the helpof one or more skilled insiders who have been suborned.
 (It’s true that manyterrorists these days are barely at Charlie’s level, but it would not be prudentto design a nuclear power station on the assumption that Charlie would be thehighest grade of attacker you have to worry about.
 And now that your powerstation’s dozens of contractors are moving their systems to the cloud, you canbet that one of them will be vulnerable to a capable motivated hacker.
)While the sociologists focus on Derek, the criminologists on Charlie andthe military on Abdurrahman, our concern is mainly with Bruno.
 He isn’t theSecurity Engineering436Ross Anderson13.
2.
 THREATS AND BARRIERShighest available grade of ‘civilian’ criminal: that distinction probably goes tothe bent bankers and lawyers who launder money for drug gangs, or the guyswho write malware for online crime gangs.
 But the physical defenses of banksand computer rooms tend to be designed with Bruno in mind.
13.
2.
2DeterrenceThe ﬁrst consideration is whether you can prevent bad people ever trying tobreak in.
 It’s a good idea to make your asset anonymous and inconspicuousif you can.
 It might be a nondescript building in the suburbs; in somewherelike Hong Kong, with its sky-high property prices, it might be half a ﬂoor of annondescript o�ce block.
Location matters; some neighbourhoods have much less crime than others.
Part of this has to do with whether other property nearby is protected, and howeasy it is for a crook to tell which properties are protected.
 If owners just installvisible alarms, they may redistribute crime to their neighbours; but invisiblealarms that get criminals caught rather than just sent next door can deter crimein a whole neighbourhood.
 For example, Ian Ayres and Steven Levitt studiedthe e↵ect on auto thefts of Lojack, a radio tag that’s embedded invisibly incars and lets the police ﬁnd them if they’re stolen.
 In towns where a lot ofcars have Lojack, car thieves are caught quickly and ‘chop-shops’ that break upstolen cars for parts are closed down.
 Ayres and Levitt found that although amotorist who installs Lojack pays about $100 a year, the social beneﬁt from hisdoing this – the reduced car crime su↵ered by others – is $1500 [148].
 The sameapplies to real estate; a neighbourhood in which lots of houses have high-gradealarms that quietly call the police is a dangerous place for a burglar to work.
In fact, physical property crimes have fallen substantially in the USA, the UKand many other countries since the early 1990s.
But that’s not all.
 Since the 1960s, there has arisen a substantial literatureon using environmental design to deﬂect and deter threats.
 Much of this evolvedin the context of low-income housing, as criminologists and architects learnedwhich designs made crime more or less likely.
 In 1961, Elizabeth Wood urgedarchitects to improve the visibility of apartment units by residents, and createcommunal spaces where people would gather and keep apartment entrances inview, thus fostering social surveillance; areas that are out of sight are morevulnerable [2036].
 In 1972, Oscar Newman developed this into the concept of‘Defensible Space’: buildings should ‘release the latent sense of territorialityand community’ of residents [1435].
Small courtyards are better than largeparks, as intruders are more likely to be identiﬁed, and residents are more likelyto challenge them.
At the same time, Ray Je↵ery developed a model thatis based on psychology rather than sociology and thus takes account of thewide di↵erences between individual o↵enders; it is reﬂected in our four ‘model’villains.
 Intruders are not all the same, and not all rational [1609].
Je↵ery’s ‘Crime Prevention Through Environmental Design’ has been inﬂu-ential and challenges a number of old-fashioned ideas about deterrence.
 Oldtimers liked bright security lights; but they create glare, and pools of shadow inwhich villains can lurk.
 It’s better to have a civilised front, with windows over-looking sidewalks and car parks.
 In the old days, cyclone fences with barbedSecurity Engineering437Ross Anderson13.
2.
 THREATS AND BARRIERSwire were thought to be a good thing; but they communicate an absence ofpersonal control.
 A communal area with picnic seating, in which activities hap-pen frequently, has a greater deterrent e↵ect.
 Trees also help, as they makeshared areas feel safer (perhaps a throwback to an ancestral environment wheregrassland with some trees helped us see predators coming and take refuge fromthem).
 Access matters too; defensible spaces should have single egress points,so that potential intruders are afraid of being trapped.
It’s been found, forexample, that CCTV cameras only deter crime in facilities such as car parkswhere there’s a single exit [766].
 There are also many tricks developed overthe years, from using passing vehicles to enhance site visibility to planting lowthorn bushes under windows.
 Railings can make better barriers than walls, asyou can see through them.
 Advice on these can be found in modern standardssuch as [324].
Another inﬂuential idea is the broken-windows theory of George Kelling andCatherine Coles [1029].
 They noted that if a building has a broken windowthat’s not repaired, then soon vandals will break more, and perhaps squattersor drug dealers will move in; if litter is left on a sidewalk then eventually peo-ple will start dumping their trash there.
So problems should be ﬁxed whenthey’re still small.
 Kelling was hired as a consultant to help New York cleanup its vandalised subways, and inspired the zero-tolerance movement of policechief William Bratton, who cracked down on public drinkers, squeegee men andother nuisances.
 Both petty crime and serious crime in New York fell sharply.
Criminologists still argue about whether the fall was due to zero tolerance, orto other simultaneous changes such as demographics [1151] and right-to-carrylaws [1188].
A related set of ideas can be found in the situational crime prevention theoryof Ronald Clarke.
This builds on the work of Je↵ery and Newman, and isbroader than just property crime; it proposes a number of principles for reducingcrime generally by increasing the risks and e↵ort, reducing the rewards andprovocations, and removing excuses.
 Its focus is largely on designing crime outof products and out of the routines of everyday life; it’s pragmatic and drivenby applications [440].
 It involves detailed study of speciﬁc threats; for example,car theft is considered to be a number of di↵erent problems, such as joyriding byjuveniles, theft to get home at night and theft by professional gangs of cars fordismantling or sale abroad – these threats are best countered by quite di↵erentmeasures.
Such empirical studies may be criticised by criminologists with asociology background as lacking ‘theory’, but are gaining inﬂuence and are notfar from what security engineers do.
 Many of the mechanisms discussed in thisbook ﬁt easily within a framework of application-level opportunity reduction.
This framework naturally accommodates the extension of environmental con-trols to other topics when needed.
 So if you’re planning on anonymity of yourhosting centres as a defence against targeted attack, you have to think abouthow you limit the number of people who know where those premises are.
 Atleast, that was the traditional approach; but it may not be the last word.
 Manyﬁrms have moved entirely to third-party cloud services and have no hosting cen-tres any more.
 This can save physical security costs, as well as sysadmin salariesand electricity.
Security Engineering438Ross Anderson13.
2.
 THREATS AND BARRIERS13.
2.
3Walls and barriersOnce you’ve decided what environmental features you’ll use to deter Derek orCharlie from trying to break into your site, and how you make it harder forBruno to ﬁnd out which of your sites he should break into, you then have theproblem of designing the physical barriers.
Your ﬁrst task is to ﬁgure out what you’re really trying to protect.
 In theold days, banks used to go to great lengths to make life really tough for robbers,but this has its limits: a robber can always threaten to shoot a customer.
 Soby the 1980s, the philosophy had shifted to ‘give him all the cash he can see’.
This philosophy has spread to the rest of retail.
 In 1997, Starbucks reviewedphysical security following an incident in which three employees were shot deadin a bungled robbery.
They decided to move the safes from the manager’so�ce to the front of the store, and made these safes highly visible not just tosta↵, customers and passers-by, but also to the control room via CCTV.
 A side-beneﬁt was improved customer service.
 The new design was tested at a numberof US locations, where increased sales and loss reductions gave a good returnon investment [505].
 I notice that people increasingly leave their car keys justinside the front door at home, rather than keeping them on their bedside table.
If someone breaks into your house at night to steal your car, do you really wantto engage them in hand-to-hand combat?Second, having settled your protection goals, you have to decide what perime-ters or boundaries you’ll have for what purposes, and where.
 A growth industryrecently has been vehicle traps to prevent cars or trucks being brought close toiconic targets, whether to carry bombs or to run down sightseers.
 But it’s amistake to focus on rare but ‘exciting’ threats at the expense of mundane ones.
Many buildings have stout walls but roofs that are easy to penetrate; perhaps aterrorist would blow himself up at your main gate to no e↵ect, but an environ-mental protester could cripple your fab and cost you hundreds of millions in lostproduction by climbing on the roof, cutting a hole and dropping some burningnewspaper.
For this reason, organisations such as NIST, the Builders’ Hardware Man-ufacturers’ Association, Underwriters’ Laboratories, and their equivalents inother countries have a plethora of test results and standards for walls, roofs,safes and so on.
 The basic idea is to assess how long a barrier will resist anattacker who has certain resources – typically hand tools or power tools.
 Nor-mal building materials don’t o↵er much delay at all; you get through a cavitybrick wall in less than a minute with a sledgehammer, and regardless of howexpensive a lock you put on your front door, a SWAT team will just break thedoor o↵ its hinges with a battering-ram.
 So could a robber.
 So the designersof data centres, bank vaults and the like favour reinforced concrete walls, ﬂoorsand roofs, with steel doorframes.
 But if the bad guys can work undisturbed allweekend, even concrete won’t keep them out.
 In England’s biggest burglary, agang of elderly criminals drilled through the 20-inch concrete wall of a safe de-posit company in Hatton Garden in 2015 and made o↵ with £14m in diamonds.
Four years later, the ringleader was caught and it emerged at trial how he’dposed as a phone company engineer to tamper with the security system, thenused a mobile phone jammer to block the alarm signal [1547].
Security Engineering439Ross Anderson13.
2.
 THREATS AND BARRIERSBeware that the organisations that certify locks, safes and vaults often makeoutdated assumptions about attack tools.
 The lock on your car steering wheelis certiﬁed to resist a man putting his weight on it; but car thieves have learnedto use a sca↵olding pole, which gives the leverage to break it.
 The typical bankvault is certiﬁed to resist attack for ten minutes, yet your local Fire Departmentcan get through in two minutes using a modern angle grinder.
 And if the badguys have access to proper explosives, they can get through almost anythingin seconds.
 Another issue is the thermic lance, or burning bar, which will cutthrough most barrier materials quickly: safe engineers use such things to getinto a vault whose combination has been lost.
 Robbers can get them too.
 Sobarriers can’t be seen in isolation.
 You have to be aware of assumptions aboutthe threats, and about the intrusion detection and response on which you canrely.
13.
2.
4Mechanical locksThe locksmithing industry has been seriously upset in recent years by devel-opments that have exposed the vulnerability of many low-cost mechanical andelectronic locks.
The ﬁrst of these is bumping.
 This technique enables many mechanical locksto be opened quickly and without damage by unskilled people using tools thatare now readily available.
Its main target is the pin-tumbler lock originallypatented by Linus Yale in 1860 (see Figure 13.
1).
 This was actually used inancient Egypt, but Yale rediscovered it and it’s often known as a ‘Yale lock’,although many other ﬁrms make them too nowadays.
Figure 13.
1: – a cutaway pin-tumbler lock (Courtesy of Marc Weber Tobias)These locks have a cylindrical plug set inside a shell, and prevented fromrotating by a number of pin stacks.
 Each stack usually consists of two or threepins, one on top of the other.
 The bottom pin or key pin makes direct contactwith the key; behind it is a spring-loaded top pin or driver pin that forces thebottom pin as far down as possible in the keyway.
 When the correct key isinserted, the gaps between the top pin and the bottom pin in each stack alignwith the edge of the plug, creating a shear line; the plug can now be turned.
 Atypical house or o�ce lock might have ﬁve or six pins each of which could havethe gap in ten di↵erent positions, giving a theoretical key diversity of 105 or106 possible key di↵ers.
 The actual number will be less because of mechanicalSecurity Engineering440Ross Anderson13.
2.
 THREATS AND BARRIERStolerances and key-cutting restrictions.
It had been known for years that such locks can be picked, given special tools.
You can ﬁnd details in the MIT Lock Picking Manual [1896] or in treatises suchas that by Marc Weber Tobias [1891]: the basic idea is that you twist the plugslightly using a tension wrench, and then manipulate the pins with a lockpickuntil they all line up along the shear line.
 Such techniques have been used byspecialists such as locksmiths for years; but they take a lot of practice, and it’sunlawful to possess the tools in many jurisdictions (for the laws in the USA,see [1893]).
 Until recently, lockpicking was generally thought to be a threat onlyto high-value targets such as investment banks and embassies.
The new discovery was that an attacker can insert a specially made bumpkey each of whose teeth is set at the lowest pin position and whose shoulder isslightly rounded.
 (Such keys are also known as ‘999’ keys as all the teeth are atthe lowest position, or bitting, namely number 9.
) The intruder can then placethe key under slight torsion with their ﬁngertips and tap the key head witha rubber mallet.
 The shock causes the pins to bounce upwards; the appliedtorsion causes them to stick as the spring pushes them back down, but with thegap at the cylinder edge.
 The net e↵ect is that with a few taps of the mallet,the lock can be opened.
This trick had been known for years, but became more e↵ective because ofbetter tools and techniques.
 It was publicised by a 2005 white paper writtenby Barry Wels and Rop Gonggrijp of The Open Organization Of Lockpick-ers (TOOOL), a Dutch ‘lock sports’ group (as amateur locksmithing is nowknown [2008]).
 TV coverage spread the message to a wide audience.
 The viewof experts is that bumping deskills lockpicking, with potentially serious conse-quences [1892].
 It’s been found, for example, that the locks in US mailboxescan be opened easily, as can the pin-tumbler locks with 70% of the US domesticmarket.
 The Dutch paper, and the subsequent publicity, kicked o↵ an armsrace, with vendors producing more complex designs and amateur locksmithsreporting bumping attacks on many of them.
 We now have lockpicking kits atmy lab so schoolkids can play with them during open days.
 They love it!Just about all metal locks have been broken.
 When I worked in banking,locks from Medeco were thought to be unpickable (and even certiﬁed as such),and were used to protect the hardware security modules in which the bank’smost important cryptographic keys were kept.
 The company had a dominantposition in the high-security lock market.
 Medeco uses secondary keying in theangle at which cuts are made in the key.
 In this ‘biaxial’ system, angled cutsrotate the pins to engage sliders.
 In 2005, Medeco introduced the m3 which alsohas a simple sidebar in the form of a slider cut into the side of the key.
 Yetin 2007, Tobias reported an attack on the m3 and biaxial locks, using a bentpaperclip to set the slider and then a combination of bumping and picking torotate the plug [1894].
What can a householder do? As an experiment, I replaced my own frontdoor lock.
The only high-security product I could ﬁnd in a store within anhour’s drive turned out to be a rebranded Mul-T-Lock device from Israel.
 Ittook two attempts to install, jamming the ﬁrst time; it then took about a weekfor family members to learn to use the more complex deadbolt, which can easilySecurity Engineering441Ross Anderson13.
2.
 THREATS AND BARRIERSfail open if operated carelessly.
 And the next time we were visited by someonewith an intelligence background, he remarked that in the UK only drug dealersﬁtted such locks; so if the police ever pass by, I might end up on their databaseas a suspect.
 The lock did not wear well; after a few years it started stickingopen, and when I removed it, I noted that some ball bearings had come out.
This dubious improvement to my home security cost me £200 as opposed to£20 for a standard product; and as in practice a burglar could always break awindow, our actual protection still depends more on our location and our dogsthan on ironmongery.
 Indeed, Yochanan Shachmurove and colleagues surveyedthe residents of Greenwich, Connecticut, and built a model of how domesticburglaries varied as a function of the precautions taken; locks and deadboltshad essentially no e↵ect, as there were always alternative means of entry suchas windows.
The most e↵ective deterrents were alarms and visible signs ofoccupancy such as cars in the drive [1709].
The situation for commercial ﬁrms is slightly better (but not much).
 Theusual standards for high-security locks in the USA, UL 437 and ANSI 156.
30,specify resistance to picking and drilling, but not to bumping; and althoughpick-resistant locks are generally more di�cult to bump, this is no guarantee.
Knowledge does exist about which lock designs resist bumping, but you have tolook for it.
 (Tobias’ paper, and www.
toool.
org, are good starting points.
)Purchasers therefore face a lemons market – as one might suspect anywayfrom the glossiness, ﬂu�ness and lack of technical content of most lock vendors’marketing literature.
 And even expensive pick-resistant locks are often poorlyinstalled by builders or OEMs; when I once had to break into a cryptographicprocessor with a Medeco lock, I found that it turned a cam made of white metal,which bent easily when we tried to lever it open.
 Indeed a recent security alertby Tobias disclosed that one of the most popular high security deadbolts couldbe mechanically bypassed by sliding a narrow screwdriver down the keyway,catching the bolt at the end and turning it, even without defeating the extensivesecurity protections within the lock.
This design had existed for more thantwenty years and the vulnerability was unknown to the manufacturer before thedisclosure.
 Many high-security installations employ similar hardware.
The second recent class of problems are master-key attacks.
 These were alsoknown to locksmiths for some time but were improved and published by MattBlaze1.
 Master-key systems are designed so that in addition to the individualkey for each door in a building, there can be a top-level master key that opensthem all – say, for use by the cleaners.
 More complex schemes are common;in our building, for example, I can open my students’ doors while the systemadministrators and cleaners can open mine.
 In pin-tumbler locks, such schemesare implemented by having extra cuts in some of the pin stacks.
 Thus insteadof having a top pin and a bottom pin with a single cut between them, some ofthe pin stacks will have a middle pin as well.
The master-key attack is to search for the extra cuts one at a time.
 Supposemy key bitting is 557346, and the master key for my corridor is 232346.
 I make1There was an interesting response: “For a few days, my e-mail inbox was full of angryletters from locksmiths, the majority of which made both the point that I’m a moron, becauseeveryone knew about this already, as well as the point that I’m irresponsible, because thismethod is much too dangerous to publish”.
 The paper is [259].
Security Engineering442Ross Anderson13.
2.
 THREATS AND BARRIERSa key with the bitting 157346, and try it in the lock.
 It doesn’t work.
 I thenﬁle the ﬁrst position down to 257346.
 As 2 is a valid bitting for the ﬁrst pin,this opens the lock, and as it’s di↵erent from my user bitting of 5, I know it’sthe master key bitting for that pin.
 I will have to try on average four bittingsfor each pin, and if three pins are master-keyed then I’ll have a master key afterabout twelve tests.
 So master keying allows much greater convenience not justto the building occupants but also to the serious burglar.
 This matters, as mostlarge commercial premises that still have metal keys use master keying.
 Thereare master-keying systems that resist this attack – for example, the Austrianlockmaker Evva has a system involving magnets embedded in metal keys thatare much harder to duplicate.
 But most ﬁelded systems appear vulnerable, andthe invention of 3-d printing has made them even more so.
A big headache with mechanical master-keying systems is revocation.
 Key-holders leave, and may be dishonest or careless.
 They may have cut a copy oftheir key, and sold it to an attacker.
 Or someone may have taken a photo of theirkey, and used it to print a copy.
 Master-key attacks are important here, andmany expensive, pick-resistant locks actually make the problem worse.
 Theyoften depend on a secondary keying mechanism such as a sidebar: the keyslook like two normal pin-tumbler keys welded together, as in Figure 11.
2.
 Thesidebar is often the same for all the locks in the building (master-keyed systemsgenerally require common sidebars in locks that share master keys).
 So if a badman can take a picture of a genuine key belonging to one of my students, hemay be able to turn it into a bump key that will open my door, and indeedevery door in the building, as in Figure 11.
3.
 This may not be a problem inuniversity premises, where there’s nothing much to steal but books.
 But it def-initely is for banks, bullion dealers and jewelers where attackers might spendtwo years planning a raid.
 If such a facility had a master-keying system usingsidebar locks, and a sta↵ member were even suspected of having leaked a key,the prudent thing would be to replace every single lock.
 So while mechanicallocks are easy to change singly, systems that integrate hundreds of locks in onebuilding may end up locking the building owner in to the lock vendor more thanthey lock the burglar out of the premises.
The combined e↵ect of bumping, bad deadbolts, master-key attacks and 3-dprinting might be summarised as follows.
 As the tools and knowledge spread, acareer criminal like Charlie will be able to open almost any house lock quicklyand without leaving any forensic trace, while more professional attackers likeBruno and Abdurrahman will be able to open the locks in most commercialpremises too.
 House locks may not matter all that much, as Charlie will just gothrough the window anyway; but the vulnerability of most mechanical locks incommercial premises could have much more complex and serious implications.
If your responsibilities include the physical protection of server rooms or otherassets, it’s time to start thinking about them.
Fig 11.
2 – key for a sidebar lockFig 11.
3 – sidebar bump keySecurity Engineering443Ross Anderson13.
2.
 THREATS AND BARRIERS13.
2.
5Electronic locksThe di�culty of revocation is just one reason why electronic locks are gettingever more market share.
 They’ve been around for a long time – hotels havebeen using card locks since the 1970s.
 There’s a host of products, using all sortsof mechanisms from contactless smartcards through PIN pads to biometrics.
Many of them can be bypassed in various ways, and most of the chapters of thisbook can be applied in one way or another to their design, evaluation and assur-ance.
 There are also some electromechanical locks that combine mechanical andelectronic (or magnetic) components; but it’s hard to get the locksmithing, thecryptography and the electromagnetic mechanisms to work together seamlessly;and you can never tell until you test them.
 Such locks not only cost more moneythan simple metal locks or card locks, but often fail in interesting ways; there’sa whole literature of attacks on them [1839, 1291].
But, from the viewpoint of a big company using locks to protect large andcomplex premises, the problem is not so much the locks themselves but howyou manage dozens or hundreds of locks in a building, especially when you havedozens or hundreds of buildings worldwide.
Newer buildings are starting to become aware of who is where, using mul-tiple sensors, and integrating physical with logical access control.
 In an idealworld, you’d know who went through which door in real time and be able toline this up with security policies on information; for example, if classiﬁed ma-terial is being handled, you can sound an alarm if there’s anyone in the roomwithout the right clearance.
 Buildings can monitor objects as well as people;in an experiment at our lab, both people and devices carried active badges forlocation tracking [1982].
 Electronic systems can be fully, or almost always, on-line, making revocation much easier.
 As well as enforcing security policy, smartbuildings could provide other beneﬁts, such as saving energy by turning lightso↵ and by tailoring air conditioning to the presence of occupants.
 But it will bea long haul.
One practical problem, as we found with one organisation I worked with,is that only a few ﬁrms sell large-scale entry control systems, and they’re hardto customise.
 In one building project, we found the vendors’ protocols didn’tsupport the kit we ideally wanted to use and we didn’t have the time or thepeople to build our own entry control system from scratch.
 The legacy entry-control vendors operate just as other systems houses do: they make their moneyfrom lockin (in the economic, rather than locksmithing sense).
You end uppaying $200 for a door lock that cost maybe $10 to manufacture, because ofproprietary cabling systems and card designs.
The main limit to the lockinis the cost of ripping and replacing the whole system – hence the proprietarycabling.
We settled for a card system to control access to sections of the building,and used Mifare contactless smartcards as they were available from multipleentry-control vendors.
 Other buildings operated by the same organisation usedthis system, and it allowed more complex access control policies that were afunction of the time of day.
 On the o�ce doors themselves we had metal doorkeys, which just have a matrix specifying which key opens which lock (thismeans a master keying system as described above).
 The organisation hoped toSecurity Engineering444Ross Anderson13.
2.
 THREATS AND BARRIERSmigrate to a more fully electronic system in time, once they could get the sortof components that would make decent systems integration possible – such asreasonably-priced door locks that run o↵ the building’s standard Ethernet.
Then an attack was found on the underlying card system, the Mifare Classic,sold by NXP Semiconductors.
 This used a proprietary cipher called Crypto-1whose key had been limited to 48 bits as a result of export controls imposedduring the crypto wars of the 1990s, which I discuss in 26.
2.
7.
 Mifare Classichad other ﬂaws including a weak random number generator and a protocolthat leaked keystream material via error messages.
 Although mostly used fortransport ticketing, it also had an installed base of tens of thousands of buildingsand was supported by several major building entry control vendors.
The Mifare Classic was partially reverse engineered by Karsten Nohl and col-leagues in 2007 [1450]; Flavio Garcia and colleagues at Nijmegen ﬁnished the jobthe following year, publishing a complete analysis of the chip and showing howa version used in tickets for all Dutch public transport could be subverted [747].
NXP tried to get a court to suppress this research, but failed.
 The e↵ect of theseattacks on Mifare was to force transport systems to deploy intrusion-detectionsystems to detect fare dodgers; the e↵ect on entry control systems was thatcard keys became easy to clone.
 Anyone with appropriate equipment who gottemporary possession of a key could make a working copy, just as with a tradi-tional metal key.
 What’s more, an ingenious attacker could deploy a fake lockand copy the key of anyone who went through it.
 That would include cleaners,whose keys open all the locks in a building, and security patrol sta↵ whose keysopen all the locks in all the company’s buildings.
 You can even put a contact-less reader into a co↵ee cup which you hold at chest height, to clone the keys ofpeople who keep them on lanyards.
Some lock vendors were badly hit.
 One vendor sold locks to hotels at nearcost price, reckoning on making its proﬁts by selling replacement card stockfor $1 a key.
The Mifare break meant that competitors from Taiwan couldsell compatible stock for a few cents, destroying their business model.
 NXPresponded with a product that added a digital signature to the card, so that thelock could tell that although it was a weak key, it was a genuine weak key.
The consequence for organisations with dozens of buildings using Mifarelocks operated by a common sta↵ card was that to move to a more secure lockthey had to either replace all the locks and cards at once, or else stick with NXP,who produced two series of successor cards.
 The ﬁrst were ‘hardened’ classiccards that still used the weak Crypto 1 cipher but ﬁxed the implementationmistakes that made the initial attacks easier; but as the underlying cipher isweak, these were broken too [1316].
 The second product line used better algo-rithms, with the DESﬁre card, for example, using two-key triple-DES.
 HoweverDavid Oswald and Christof Paar promptly discovered a timing attack on theDESﬁre [1484].
 The problem was partly mitigated by entrepreneurial lock ven-dors who started to produce card readers that could cope with multiple productlines; one will cope not only with Mifare but also with NFC (for Android phones)and Bluetooth (for phones made by Apple, which locks down the NFC chip toApple pay).
 Others are embracing new technologies such as the new 802.
15.
4zstandard for UWB radio which I mentioned in section 4.
3.
1.
Security Engineering445Ross Anderson13.
3.
 ALARMSIn short, NXP managed to maintain much of its lock-in by migrating itscustomers to new products but at some cost in security.
 Some of the externalitiesthis created were captured by more alert card reader vendors.
However thewhole ﬁeld has become way too complex for the traditional lock buyer, who wasan architect or building services manager.
 That’s yet another reason why theCISO’s security engineering team needs to take an interest in physical securitytoo.
13.
3AlarmsAlarms are used to deal with much more than burglary.
Their applicationsrange from monitoring freezer temperatures in supermarkets (so sta↵ don’t ‘ac-cidentally’ switch o↵ freezer cabinets in the hope of being given food to takehome), right through to improvised explosive devices in conﬂict zones that areoften booby-trapped.
 However, it’s convenient to discuss them in the contextof burglary and of protecting server rooms, bank vaults or art galleries.
 Alarmsalso give us a good grounding in the wider problem of service denial attacks,which are an issue everywhere from gaming to electronic warfare.
Standards for building alarms vary between countries and between di↵erenttypes of risk.
 As with locks, you’ll normally use a specialist ﬁrm for this kindof work; but you must be aware of the technical issues.
 My own professionalexperience has ranged from the alarms built into automatic teller machines,through the security of the communications used by an alarm system for largerisks such as wholesale jewelers, to the systems used to protect bank computerrooms.
An alarm in a server room is well protected from tampering (at least byoutsiders).
 So I’ll take as my case study an art gallery.
 This has the interestingdesign problem of safeguarding precious objects and also displaying them.
 At-tackers can come in during the day as members of the public, and we’ll assumethat the attacker is Bruno – the educated professional art thief.
 The moviescriptwriter’s view of Bruno is that he organizes cunning attacks on alarms,having spent days poring over the building plans in the town hall:How to steal a painting (1)A Picasso is stolen from a gallery with ‘state-of-the-art’ alarm sys-tems by a thief who removes a dozen rooﬁng tiles and lowers himselfdown a rope so as not to activate the pressure mats under the carpet.
He grabs the painting, climbs back out without touching the ﬂoor,and is paid by a wealthy gangster who commissioned the theft.
The press loves this kind of stu↵, and it does happen from time to time.
Reality is both simpler and stranger.
 Let’s work through the threat scenariossystematically.
Security Engineering446Ross Anderson13.
3.
 ALARMS13.
3.
1How not to protect a paintingA common mistake when designing alarm systems is to be captivated by thelatest sensor technology.
 There’s a lot of impressive stu↵ on the market, such asa ﬁber optic cable which you can loop round protected objects and which willalarm if the cable is stretched or relaxed by less than 100nm – a ten-thousandthof a millimeter.
 Isn’t modern science marvellous? So the na¨ıve art gallery ownerwill buy a few feet of this magic cable, glue it to the back of his prize Picassoand connect it to an alarm company.
 That would detect the chap in the bosun’schair.
 So how would you defeat it? Well, that’s easy.
How to steal a painting (2)Bruno comes in as a tourist and hides in a broom cupboard.
 At onein the morning, he emerges, snatches the painting and heads for theﬁre exit.
 O↵ goes the alarm, but so what! In less than a minute,he’ll be on his motorbike.
 By the time the cops arrive twelve minuteslater he’s gone.
Alarms are rarely integrated well with building entry controls.
 Many design-ers don’t realise that unless you can positively account for all the people who’veentered the premises during the day, you’d better take precautions against the‘stay-behind’ villain – even if this is only an inspection tour after the galleryhas closed.
 Serious physical security means serious controls on people.
 In fact,the ﬁrst recorded use of the RSA cryptosystem – in 1978 – was not to encryptcommunications but to provide digital signatures on credentials used by sta↵ toget past the entry barrier to a plutonium reactor at Idaho Falls.
 The creden-tials contained data such as body weight and hand geometry [1747, 1751].
 ButI’m still amazed by the ease with which building entry controls are defeated atmost secure sites I visit – whether by mildly technical means, such as sittingon somebody else’s shoulders to go through an entry booth, or (most often) byhelpful people holding the door open.
What’s more, the alarm response process often hasn’t been thought through.
(The Titanic E↵ect of over-reliance on the latest technology often blinds peopleto common sense.
)So we mustn’t think of the alarm mechanism in isolation.
 As I mentionedabove, a physical protection system has several steps: deter – detect – alarm –delay – respond, and the emphasis will vary from one application to another.
 Ifour opponent is Derek or Charlie, we’ll mostly be concerned with deterrence.
At the sort of targets where Abdurrahman might try to steal ﬁssile materials,an attack will almost certainly be detected; the main problem is to delay himlong enough for the Marines to arrive.
 Bruno is the most interesting case as wewon’t have the military budget to spend on keeping him out, and there are manymore premises whose defenders worry about Bruno than about Abdurrahman.
So you have to look carefully and decide whether the bigger problem is withdetection, with delay or with response.
Security Engineering447Ross Anderson13.
3.
 ALARMS13.
3.
2Sensor defeatsBurglar alarms use a wide range of sensors, including:• vibration detectors, to sense fence disturbance, footsteps, breaking glassor other attacks on buildings or perimeters;• switches on doors and windows;• passive infrared devices to detect body heat;• motion detectors using ultrasonics or microwave;• invisible barriers of microwave or infrared beams;• pressure pads under the carpet, which in extreme cases may extend toinstrumenting the entire ﬂoor with pressure transducers under each tile;• video cameras, nowadays often with movement detectors and even face de-tectors, to alarm automatically or provide a live video feed to a monitoringcenter;• movement sensors on equipment, ranging from simple tie-down cablesthrough seismometers to loops of optical ﬁber.
Most sensors can be circumvented.
 Fence disturbance sensors can be defeatedby vaulting the fence; motion sensors by moving very slowly; door and windowswitches by breaking through a wall.
 Designing a good combination of sensorscomes down to skill and experience (with the latter not always guaranteeing theformer).
 A standard, if slightly dated, reference on sensor installation is [408].
The main problem is limiting the number of false alarms.
 Ultrasonics don’tperform well near moving air such as central heating inlets, while vibrationdetectors can be rendered useless by tra�c.
 Severe weather, such as lightning,will trigger most systems, and a hurricane can swamp a town’s police forcenot just with rain but with thousands of false alarms.
 In some places, evennormal weather can make protection di�cult: how do you defend a site wherethe intruder might be able to ski over your sensors (and even over your fence)2?But regardless of whether you’re in Alaska or Arizona, the principal dilemmais that the closer you get to the object being protected, the more tightly youcan control the environment and so the lower the achievable false alarm rate.
Conversely, at the perimeter it’s hard to keep the false alarm rate down.
 But todelay an intruder long enough for the guards to get there, the outer perimeteris exactly where you need reliable sensors.
How to steal a painting (3)So Bruno’s next attack is to wait for a dark and stormy night.
 Hesets o↵ the alarm somehow, taking care not to get caught on CCTV2For an instructive worked example of intruder detection for a nuclear power station in asnow zone see [173].
Security Engineering448Ross Anderson13.
3.
 ALARMSor leave any other hard evidence that the alarm was a real one.
 Heretires a few hundred yards and hides in the bushes.
 The guardscome out and ﬁnd nothing.
 He waits half an hour and sets o↵ thealarm again.
 This time the guards don’t bother, so in he goes.
False alarms – whether induced deliberately or not – are the bane of the in-dustry.
 They are a denial-of-service attack on the alarm response force.
 Experi-ence from electronic warfare is that a false alarm rate of greater than about 15%degrades the performance of radar operators; and most intruder alarm respon-ders are operating well above this threshold.
 Deliberately induced false alarmsare especially e↵ective against sites that don’t have round-the-clock guards.
Many police forces have a policy that after a certain number of false alarmsfrom a given site (typically three to ﬁve per year), they will no longer send asquad car there until the alarm company, or another keyholder, has been thereto check.
False alarms degrade systems in other ways.
 The rate at which they arecaused by environmental stimuli such as weather conditions and tra�c noiselimits the sensitivity of the sensors that can usefully be deployed.
 Also, thevery success of the alarm industry has greatly increased the total number ofalarms and thus decreased police tolerance of false ones.
 A common strategy isto have remote video surveillance as a second line of defense, so the customer’spremises can be inspected by the alarm company’s dispatcher; many policeforces prioritize alarms conﬁrmed in this way [979].
 But even video links arenot a panacea.
 The attacker can disable the lighting, start a ﬁre, or set o↵ alarmsin other buildings in the same street.
 The failure of a telephone exchange, as aresult of a ﬂood or hurricane, may lead to opportunistic looting.
After tra�c and weather, Bruno’s next ally is time.
 Vegetation grows intothe path of sensor beams, fences get slack so the vibration sensors don’t workso well, the criminal community learns new tricks, and meanwhile the sentriesbecome complacent.
So sites needing serious physical protection often have several perimeters: anouter fence to keep out the drunks and the wildlife; then level grass with buriedsensors, an inner fence with an infrared barrier, and ﬁnally a massive enoughbuilding to delay the bad guys until the cavalry gets there.
 The regulations laiddown by the International Atomic Energy Agency for sites that hold more than15g of plutonium are an instructive read [949].
At most sites this kind of protection will be too expensive.
 And even if youhave loads of money, you may be somewhere like Manhattan or Hong Kongwhere real estate’s expensive: if you have to be near the exchange to tradequickly enough, your bank computer room may just be a ﬂoor of an o�cebuilding and you’ll have to protect it as best you can.
 A good example comesfrom a gang of jewel thieves in Florida who targeted retail stores that shareda wall with a store such as a nail salon that had no reason to install an alarm.
They broke in there, then cut through the wall into the jewelry store [1215].
Anyway, the combination of sensors and physical barriers still makes up lessthan half the story.
Security Engineering449Ross Anderson13.
3.
 ALARMS13.
3.
3Feature interactionsIntruder alarms and barriers interact in a number of ways with other services.
The most obvious of these is electricity.
 A power cut will leave many sites darkand unprotected, so a serious alarm installation needs backup power.
 A lessobvious interaction is with ﬁre alarms and ﬁreﬁghting.
How to steal a painting (4)Bruno visits the gallery as a tourist and leaves a smoke grenade ona timer.
 It goes o↵ at one in the morning and sets o↵ the ﬁre alarm,which in turn causes the burglar alarm to ignore signals from itspassive infrared sensors.
(If it doesn’t, the alarm dispatcher willignore them anyway as he concentrates on getting the ﬁre trucksto the scene.
) Bruno smashes his way in through a ﬁre exit andgrabs the Picasso.
 He’ll probably manage to escape in the generalchaos, but if he doesn’t he can always claim he was a public-spiritedbystander who saw the ﬁre and risked his life to save the town’spriceless cultural heritage.
 The police might not believe him, butthey’ll have a hard time convicting him.
The largest ever burglary – the theft in 2019 of about a billion Euros’ worthof treasures from the Gr¨une Gew¨olbe in Dresden, the home of Augustus theStrong’s treasure chamber and a dozen other rooms of priceless antiquities, usedarson [469].
 A ﬁre at a nearby building site disabled the local electricity sub-station, turning o↵ local streetlights as well as the power to the museum [1045].
Its security guards eventually saw intruders on CCTV and called the police, butthey didn’t get there in time.
The interaction between ﬁre and intrusion is always di�cult.
 At nuclearreactors, there’s typically a rule that if a bomb is discovered, the site is lockeddown, with no-one allowed in or out; and a ﬁre safety rule that in the eventof a blaze, much of the sta↵ have to be evacuated (plus perhaps some of thelocal population too).
 This raises the interesting question of which rule prevailsshould a bomb ever go o↵.
And some ﬁre precautions may only be used ifyou can keep out innocent intruders.
 Many server rooms have automatic ﬁreextinguishers, and this often means ﬂooding with carbon dioxide.
 A CO2 dumpcan be lethal to untrained people: you have to get out of the room on the airyou have in your lungs as visibility drops to a few inches and you’re disorientedby the terrible shrieking noise of the dump.
 A nitrogen dump is less spectacularbut also lethal; a falling oxygen level doesn’t provoke a panic response the waya rising CO2 level does.
But the most severe feature interactions are between alarms and communi-cations.
13.
3.
4Attacks on communicationsA sophisticated attacker is at least as likely to attack the communications asthe sensors.
 Sometimes this will mean the cabling between the sensors and theSecurity Engineering450Ross Anderson13.
3.
 ALARMSalarm controller.
How to steal a painting (5)Bruno goes into an art gallery and, while the sta↵ are distracted, hecuts the wire from a window switch.
 He goes back that evening andhelps himself.
It’s also possible that one of your sta↵, or a cleaner, will be bribed, seducedor coerced into creating a vulnerability.
 In Britain’s biggest robbery, in February2006 from the Securitas Cash Management depot in Tonbridge, Kent, robberstook the manager and his family hostage, pretending to be police o�cers.
 Theythen compelled him to let them in, taking £53,116,760; although ﬁve of therobbers were caught and jailed, others escaped and most of the money wasnever recovered.
 When I worked in banking back in the 1980s, we took care tobrief our cash centre managers that the controls were there to stop their familiesbeing taken hostage.
 It’s great to have knowledgeable and motivated defenders,but the dual-control defence must be carried through in depth.
High-valuesites with capable defenders insist that alarm maintenance and testing be doneby two people rather than one.
 Even then, dual control isn’t always enough,especially if your opponent is Abdurrahman rather than Bruno.
 In Britain’sfourth-largest ever robbery, the Provisional IRA kidnapped two keyholders atthe Northern Bank in December 2004 and held their families at gunpoint, toforce them to let them into the bank’s Belfast headquarters the next day.
 Theterrorists escaped with £26.
4m, and in order to make most of the money useless,the £50 notes they stole were withdrawn from circulation.
 Another edge case isthe prison system, where attacks on sensors, cabling and indeed the very fabricof the building are so frequent that a continuing program of test and inspectionis essential.
 It can be useful to ask yourself, “How would I do this di↵erently ifhalf my sta↵ were convicts on day release?” and “How would I cope if a handfulof my sta↵ were working for an organisation that decided to rob me?” I willdiscuss the implications of dual control in more detail in the chapter on bankingand bookkeeping.
The old-fashioned way of protecting the communications between the alarmsensors and the controller was physical: lay multiple wires to each sensor andbury them in concrete, or use armored gas-pressurized cables.
 The more modernway is to encrypt the communications [706].
 So how do you attack those?How to steal a painting (6)Bruno phones up a rival gallery claiming to be from the securitycompany that handles their alarms.
 He says that they’re updatingtheir computers so could they please tell him the serial number ontheir alarm controller unit? An o�ce junior helpfully does so – notrealising that the serial number on the box is also the crypto key thatsecures the communications.
 Bruno buys an identical controller for$200 and now has a functionally identical unit which he splices intohis rival’s phone line.
 This continues to report ‘all’s well’ even whenit isn’t.
Security Engineering451Ross Anderson13.
3.
 ALARMSSubstituting bogus alarm equipment, or a computer that mimics it, is knownas ‘spooﬁng’.
 There have been reports for many years of black boxes that spoofvarious alarm controllers.
 As early as 1981, thieves made o↵ with $1.
5 millionin jade statues and gold jewelry imported from China, driving the importerinto bankruptcy.
 The alarm system protecting its warehouse in Hackensack,New Jersey, was cut o↵.
 Normally that would trigger an alarm at a securitycompany, but the burglars attached a homemade electronic device to an externalcable to ensure continuous voltage [861].
 And I mentioned in section 13.
2.
3 howBritain’s biggest burglary involved jamming the alarm signal.
With the better modern systems, either the alarm controller in the vaultsends a cryptographic pseudorandom sequence to the alarm company, whichwill assume the worst if it’s interrupted, or the alarm company sends periodicrandom challenges to the controller which are encrypted and returned, just aswith IFF.
 However, the design is often faulty, having been done by engineerswith no training in security protocols.
 The crypto algorithm may be weak, or itskey may be too short (whether because of incompetence or export regulations).
Even if not, Bruno might be able to record the pseudorandom sequence andreplay it slightly more slowly, so that by early Monday morning he might haveaccumulated ﬁve minutes of ‘slack’ to cover a lightning raid.
An even more frequent cause of failure is the gross design blunder.
 One ismaking the crypto key equal to the device serial number.
 This often appearsin the purchase order, invoice, and other paperwork which lots of people get tosee.
 (It’s a good idea to buy your alarm controller for cash.
 This also makesit less likely that you’ll get one that’s been ‘spiked’.
 But big ﬁrms often havedi�culty doing this.
)By now you’ve probably decided not to go into the art gallery business.
 ButI’ve saved the best for last.
 Here is the most powerful attack on burglar alarmsystems.
 It’s a variant on (3) but rather than targeting the sensors, it goes forthe communications.
How to steal a painting (7)Bruno cuts the phone line to his rival’s gallery and hides a few hun-dred yards away in the bushes.
 He counts the number of men inblue uniforms who arrive, and the number who depart.
 If the twonumbers are equal, then it’s a fair guess the custodian has said, ‘Ohbother, we‘ll ﬁx it in the morning’, or words to that e↵ect.
 He nowknows he has several hours to work.
This is more or less the standard way to attack a bank vault, and it’s alsobeen used on computer installations.
 The modus operandi can vary from simplyreversing a truck into the phone company’s kerbside junction box, to more so-phisticated attempts to cause multiple simultaneous alarms in di↵erent premisesand swamp the local police force.
 (This is why it’s so much more powerful thanjust rattling the fence.
)In one case, thieves in New Jersey cut three main telephone cables, knockingout phones and alarm apparatus in three police stations and thousands of homesand businesses in the Hackensack Meadowlands.
 They used this opportunity toSecurity Engineering452Ross Anderson13.
3.
 ALARMSsteal Lucien Piccard wristwatches from the American distributor, with a valueof $2.
1 million wholesale and perhaps $8 million retail [861].
 In another, anOklahoma deputy sheri↵ cut the phone lines to 50,000 homes in Tulsa beforeburgling a narcotics warehouse [1923].
 In a third, a villain blew up a telephoneexchange, interrupting service to dozens of shops in London’s jewelry quarter.
Blanket service denial attacks of this kind, which saturate the response force’scapacity, are the burglarious equivalent of a nuclear strike.
The move fromphones to broadband has changed nothing; instead of cutting the BT phoneline, a British burglar now cuts the BT Openreach DSL line, which is the samepiece of copper, but now carrying digital signals.
In places where the cablecompany carries broadband, you cut that; so an American burglar will learnhow to recognise Comcast cables, if they’re the local supplier.
 What’s more,alarm services often partner with the broadband providers, leaving the ﬁrmsthat supply the sensors competing in low-cost volume markets where they don’thave the incentive to do anything sophisticated.
Future attacks might not involve snips or explosives, but a distributed denial-of-service attack on network facilities.
 Rather than causing all the alarms to goo↵ in the neighborhood of a local telephone exchange (which could be protectedto some extent by swamping it with police), it might be possible to set o↵ severalthousand alarms all monitored by the same alarm company, or by attackingsome other component in the response chain.
 This might include attacks onpolice communications, or on 4G networks now that these are used for morealarm communications than wireline.
 One way of minimising the number ofvulnerable components is by making the alarm communications anonymous, sothat service-denial attacks can’t be targeted [1423].
For years, the rule in the London insurance market (which does most of theworld’s major reinsurance business) was that alarm controllers in premises in-sured for over £20 million must have two independent means of communication.
The traditional approach was one alarm using wireline communications and oneusing cellular radio; by 2019 we’re seeing o↵erings that use two di↵erent 4g ra-dio services.
 This opens the prospect of jamming, as used in the 2015 HattonGarden burglary mentioned in section 13.
2.
3.
 In the nuclear world, IAEA reg-ulations stipulate that sites containing more than 500g of plutonium or 2kg ofU-235 must have both their alarm control center and an armed response forceon the premises [949].
Where the asset you’re protecting isn’t a vault but a hosting center, thenetwork is also critical to your operations.
 There’s little point in having eight-inch concrete walls and roofs if the single ﬁbre connecting you to the worldruns through a kerbside junction box.
 You’ll want at least two buried ﬁbresgoing to at least two di↵erent telcos – and you will want them to be usingswitches and routers from two di↵erent vendors.
Even so, the simplest wayfor a knowledgeable opponent to take out a hosting centre is usually to cut itscommunications.
 That’s one reason why small ﬁrms have two centres and thebig service ﬁrms have dozens.
 If you’re not operating at cloud scale, you maywant to ask yourself: who wants to dig, who knows where to, and would youdetect them in time?Finally, it’s worth bearing in mind that many physical security incidentsarise from angry people coming into the workplace – whether spouses, formerSecurity Engineering453Ross Anderson13.
3.
 ALARMSemployees or customers.
 In countries where private ownership of ﬁrearms iswidespread, you have to plan for shooters.
13.
3.
5Lessons learnedThe reader might still ask why a book that’s essentially about security in com-puter systems should spend several pages describing walls, locks and alarmsystems.
 There are more reasons than the obvious ones.
• Most locks can be defeated.
 Metal keys can be photographed and forgeriesmade with a 3-d printer, or even an old-fashioned ﬁle; the locks they opencan often be bumped.
 Card keys can often be cloned if you can get close.
So alarms matter.
• Dealing with service denial attacks is the hardest part of many securesystem designs, and also often the most important.
 Intruder alarms giveus applicable knowledge and experience.
• One very general lesson is that one must look at the overall system – fromdeterrence through detection, alarm, delay and response.
• Another is the observation that the outermost perimeter defenses are theones that you’d most like to rely on, but also the ones on which the leastreliance can be placed.
• The trade-o↵ between the missed alarm rate and the false alarm rate – thereceiver operating characteristic – is also a pervasive problem in securityengineering.
• It’s hard work to keep guards alert, especially in jobs where almost allalarms are false alarms.
 The classic example is airport screening, where theUS Transportation Security Administration puts test guns into suitcases,whether physically or using software in the X-ray machines.
 They havefound that only about 20% of threats get through if you test screenersseveral times per checkpoint per shift, but this rises to 60–75% if you onlytest once [713].
• Failure to understand the threat model – designing for Charlie and hopingto keep out Bruno – causes many real-life failures.
 You need to know whatactually goes wrong, not just what crime writers think goes wrong.
• And ﬁnally, you can’t just leave the technical aspects of a security engi-neering project to specialist subcontractors, as critical stu↵ will alwaysfall down between the cracks.
There are other applications where the experience of the alarm industry isrelevant.
 In a later chapter, I’ll discuss tamper-resistant processors that aredesigned to detect attempts to penetrate them and respond by destroying alltheir cryptographic key material.
Security Engineering454Ross Anderson13.
4.
 SUMMARY13.
4SummarySecurity engineers have to deal with physical protection as well as with com-puters and cipher systems.
 Just as the conﬂuence of computers and telecommssaw computer-industry equipment and methods displace the old phone-companyways of doing things, so the automation of physical protection systems is steadilybringing the world of barriers, locks and alarms within our orbit.
 The move to‘smart buildings’ means entry controls, alarms and system security integratedwith energy management and much else.
 The design, implementation and man-agement of such complex artefacts will increasingly be the job of systems securitypeople.
In this chapter, I highlighted a few things worth noting.
 First, environmentaldeterrence matters; things like architecture, landscaping and lighting can makea real di↵erence to the likelihood of intrusion.
Second, locks are not as secure as you might think.
 Recent developmentsin covert entry technology have led to wide publication of attacks that com-promise most mechanical locks, and even the expensive ‘high-security’ o↵erings.
Many card key systems are also vulnerable, as the most common products werecompromised by US export controls in the 1990s and the process of replacingthem with better ones has been held up by industry structures and incentives.
Knowing what’s good and what’s not is not possible unless you understand atleast the basics of cryptography, protocols and tamper-resistance; it’s a job forsecurity engineers, not for retired cops.
Third, there’s quite a lot to learn from the one aspect of physical securitythat’s already fairly well automated, namely alarms.
 Alarms provide us witha good example of a system whose security policy hinges on availability ratherthan on conﬁdentiality or integrity.
 They can give us some useful insights whendealing with service-denial attacks in other contexts.
Research ProblemsAt the strategic level, the conﬂuence of physical security and systems securityis bound to throw up all sorts of new problems.
 I expect that novel researchchallenges will be found by those who explore the information / physical securityboundary; an example that came up as we were going to press in 2020 is the useof acoustic side-channels.
 Given a decent microphone, you can record the clicksas a Yale key is pushed into a keyway, and use it to deduce the key bitting [1225].
No doubt there will be more results of this kind.
 From the viewpoint of securityeconomics, the problems of the locksmithing industry would make an excellentthesis topic: how the vulnerabilities found in Mifare and other products havebeen dealt with all along the supply chain is a complex story that nobody, asfar as I’m aware, has really analysed systematically.
 It might be fascinating tocompare this with how other complex ecoystems have responded to the securityfailure of key components.
At the technical level, we will probably need better mechanisms for specifyingand implementing policy engines that can manage both physical and other formsSecurity Engineering455Ross Anderson13.
4.
 SUMMARYof protection.
 As for low-level mechanisms, we could do with better tools tomanage keys in embedded systems.
 As one engineer from Philips put it to me,will the smart building mean that I have to perform a security protocol everytime I change a lightbulb? And will smart buildings end up being open, in thesense that so many di↵erent service ﬁrms will have access to the plans that allcapable opponents must be assumed to have a copy? But if you really want thebad guys to not know the precise location of the alarm response centre in yournuclear power station, how do you keep that information conﬁdential? All yourcontractors will happily claim to be ISO 27001 certiﬁed, but then so is almostevery ﬁrm that owns up to a big data breach.
Further ReadingThe classic reference on alarm systems is [173] while some system issues arediscussed in [1423].
 Resources for speciﬁc countries are often available throughtrade societies such as the American Society for Industrial Security [45], andthough the local insurance industry; many countries have a not-for-proﬁt bodysuch as Underwriters’ Laboratories [1916] in the USA, and schemes to certifyproducts, installations or both.
 For progress on lock bumping and related topics,I’d monitor the Toool group, Marc Weber Tobias, and Matt Blaze; Matt has alsowritten on safecracking [261].
 Research papers on the latest sensor technologiesappear at the IEEE Carnahan conferences [952].
 Finally, the systems used tomonitor compliance with nuclear arms control treaties are written up in [1748].
Security Engineering456Ross Anderson